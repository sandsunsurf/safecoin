name: safecoind  # you probably want to 'snapcraft register <name>'
base: core18 # the base snap is the execution environment for this snap
version: '0.1' # just for humans, typically '1.2+git' or '1.3.2'
summary: SafeCoin daemon# 79 char long summary
description: |
  This will install just the daemon and CLI wallet

grade: devel # must be 'stable' to release into candidate/stable channels
confinement: devmode # use 'strict' once you have the right plugs and slots

parts:
  openssl:
    plugin: nil
    source: https://www.openssl.org/source/openssl-1.0.1j.tar.gz
    build-packages:
      - g++
      - build-essential
      - libtool
    override-build: |
      echo "Downgrading OpenSSL to 1.0.1j"
      sudo ./config
      sudo make
      echo "Make depends OpenSSL to 1.0.1j"
      sudo make depend
      echo "Make install OpenSSL to 1.0.1j"
      sudo make install
      echo "Linking OpenSSL to 1.0.1j"
      sudo ln -sf /usr/local/ssl/bin/openssl `which openssl`
  safecoind:
    # See 'snapcraft plugins'
    plugin: nil
    source: .
    build-packages:
      - build-essential
      - pkg-config
      - libc6-dev
      - m4
      - g++-multilib
      - autoconf
      - libtool
      - ncurses-dev
      - unzip
      - git
      - python
      - python-zmq
      - zlib1g-dev
      - wget
      - libcurl4-gnutls-dev
      - bsdmainutils
      - automake
      - curl
      - bc 
      - dc 
      - jq
      - libboost-all-dev
    stage-packages:
      - build-essential
      - pkg-config
      - libc6-dev
      - m4
      - g++-multilib
      - autoconf
      - libtool
      - ncurses-dev
      - unzip
      - git
      - python
      - python-zmq
      - zlib1g-dev
      - wget
      - libcurl4-gnutls-dev
      - bsdmainutils
      - automake
      - curl
      - bc 
      - dc 
      - jq
      - libboost-all-dev
    override-build: |
      ./zcutil/build.sh -j2
      cp $SNAPCRAFT_PART_BUILD/src/safecoind $SNAPCRAFT_PART_INSTALL/bin/

apps:
  safecoind:
    command: bin/safecoind
    plugs: [home, network, network-bind]
    #daemon: simple
    environment:
      XDG_DATA_DIRS: $SNAP_USER_DATA:/var/lib/snapd/desktop:$XDG_DATA_DIRS
      # Override HOME so the datadir is located at
      # ~/snap/safecoin/common/.safecoin/ see Denarius snapcraft.yaml for more info
      # have to figure out how to maybe use echo or cat to create a safecoin.conf and have to figure out how to download zcash params and put them in correct location